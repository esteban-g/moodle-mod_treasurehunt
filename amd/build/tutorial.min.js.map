{"version":3,"sources":["../src/tutorial.js"],"names":["define","$","introJS","str","notification","launchedittutorial","intro","terms","stringQueried","map","term","key","component","show","get_strings","done","strings","hide","configureEditIntro","start","fail","exception","editpage","on","introEditProgress","localStorage","getItem","launchplaytutorial","addClass","removeClass","configurePlayIntro","playpage","introPlayProgress","keys","setOptions","nextLabel","indexOf","prevLabel","skipLabel","doneLabel","steps","element","position","onexit","setItem","oncomplete","onchange","onafterchange","target","parentElem","parentElement","dataset","role","style"],"mappings":"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","sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * @module    mod_treasurehunt/tutorial\n * @package   mod_treasurehunt\n * @copyright 2016 onwards Juan Pablo de Castro <jpdecastro@tel.uva.es>\n * @author Juan Pablo de Castro <jpdecastro@tel.uva.es>\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine([\n  \"jquery\",\n  \"mod_treasurehunt/intro\",\n  \"core/str\",\n  \"core/notification\",\n], function ($, introJS, str, notification) {\n  let init = {\n    launchedittutorial: function () {\n      let intro = introJS();\n      let terms = [\n        \"nextstep\",\n        \"prevstep\",\n        \"skiptutorial\",\n        \"donetutorial\",\n        \"welcome_edit_tour\",\n        \"map_tour\",\n        \"mapplay_tour\",\n        \"roads_tour\",\n        \"stages_tour\",\n        \"addroad_tour\",\n        \"addstage_tour\",\n        \"save_tour\",\n        \"editend_tour\",\n      ];\n      let stringQueried = terms.map((term) => {\n        return { key: term, component: \"treasurehunt\" };\n      });\n      $(\".treasurehunt-editor-loader\").show();\n      str\n        .get_strings(stringQueried)\n        .done((strings) => {\n          $(\".treasurehunt-editor-loader\").hide();\n          configureEditIntro(intro, strings, terms);\n          intro.start();\n        })\n        .fail(notification.exception);\n    },\n    editpage: function () {\n      $(\"#edition_maintitle > h2 > a\").on(\"click\", this.launchedittutorial);\n      const introEditProgress = localStorage.getItem(\"introEditProgress\");\n      if (introEditProgress != \"Done\") {\n        this.launchedittutorial();\n      }\n    }, // end of editpage function\n    launchplaytutorial: function () {\n      let intro = introJS();\n      let terms = [\n        \"nextstep\",\n        \"prevstep\",\n        \"skiptutorial\",\n        \"donetutorial\",\n        \"welcome_play_tour\",\n        \"lastsuccessfulstage_tour\",\n        \"mapplay_tour\",\n        \"validatelocation_tour\",\n        \"autolocate_tour\",\n        \"playend_tour\",\n      ];\n      let stringQueried = terms.map((term) => {\n        return { key: term, component: \"treasurehunt\" };\n      });\n      $(\".global-loader\").addClass(\"active\");\n      str\n        .get_strings(stringQueried)\n        .done((strings) => {\n          $(\".global-loader\").removeClass(\"active\");\n          configurePlayIntro(intro, strings, terms);\n          intro.start();\n        })\n        .fail(notification.exception);\n    },\n    playpage: function () {\n      $(\"#playerhelp\").on(\"click\", this.launchplaytutorial);\n      const introPlayProgress = localStorage.getItem(\"introPlayProgress\");\n      if (introPlayProgress != \"Done\") {\n        this.launchplaytutorial();\n      }\n    }, // ...end of playpage function.\n  }; // ...end of init let.\n  return init;\n}); // ...end of module define function.\n\nfunction configureEditIntro(intro, strings, keys) {\n  intro.setOptions({\n    nextLabel: strings[keys.indexOf(\"nextstep\")],\n    prevLabel: strings[keys.indexOf(\"prevstep\")],\n    skipLabel: strings[keys.indexOf(\"skiptutorial\")],\n    doneLabel: strings[keys.indexOf(\"donetutorial\")],\n    steps: [\n      {\n        element: \"#treasurehunt-editor\",\n        intro: strings[keys.indexOf(\"welcome_edit_tour\")],\n        position: \"floating\",\n      },\n      {\n        element: \"#mapedit\",\n        intro: strings[keys.indexOf(\"map_tour\")],\n        position: \"floating\",\n      },\n      {\n        element: \"#roadlist\",\n        intro: strings[keys.indexOf(\"roads_tour\")],\n        position: \"top\",\n      },\n      {\n        element: \"#stagelistpanel\",\n        intro: strings[keys.indexOf(\"stages_tour\")],\n        position: \"right\",\n      },\n      {\n        element: \"#addroad\",\n        intro: strings[keys.indexOf(\"addroad_tour\")],\n        position: \"bottom\",\n      },\n      {\n        element: \"#addstage\",\n        intro: strings[keys.indexOf(\"addstage_tour\")],\n        position: \"bottom\",\n      },\n      {\n        element: \"#savestage\",\n        intro: strings[keys.indexOf(\"save_tour\")],\n        position: \"bottom\",\n      },\n      {\n        element: \"#treasurehunt-editor\",\n        intro: strings[keys.indexOf(\"editend_tour\")],\n        position: \"floating\",\n      },\n    ],\n  });\n  intro.onexit(() => {\n    localStorage.setItem(\"introEditProgress\", \"Done\");\n  });\n  intro.oncomplete(() => {\n    localStorage.setItem(\"introEditProgress\", \"Done\");\n  });\n  intro.onchange(() => {\n    localStorage.setItem(\"introEditProgress\", \"Done\");\n  });\n}\n// end of configureEditIntro\nfunction configurePlayIntro(intro, strings, keys) {\n  intro.setOptions({\n    nextLabel: strings[keys.indexOf(\"nextstep\")],\n    prevLabel: strings[keys.indexOf(\"prevstep\")],\n    skipLabel: strings[keys.indexOf(\"skiptutorial\")],\n    doneLabel: strings[keys.indexOf(\"donetutorial\")],\n    steps: [\n      {\n        intro: strings[keys.indexOf(\"welcome_play_tour\")],\n        position: \"floating\",\n      },\n      {\n        element: \"#cluebutton\", //#lastsuccessfulstage',\n        intro: strings[keys.indexOf(\"lastsuccessfulstage_tour\")],\n        position: \"top\",\n      },\n      {\n        element: \"#mapplay\",\n        intro: strings[keys.indexOf(\"mapplay_tour\")],\n        position: \"floating\",\n      },\n      {\n        element: \"#validatelocation\",\n        intro: strings[keys.indexOf(\"validatelocation_tour\")],\n        position: \"auto\",\n      },\n      {\n        element: \"#autolocate\",\n        intro: strings[keys.indexOf(\"autolocate_tour\")],\n        position: \"auto\",\n      },\n      {\n        element: \"#treasurehunt-editor\",\n        intro: strings[keys.indexOf(\"playend_tour\")],\n        position: \"floating\",\n      },\n    ],\n  });\n  intro.onexit(() => {\n    localStorage.setItem(\"introPlayProgress\", \"Done\");\n  });\n  intro.oncomplete(() => {\n    localStorage.setItem(\"introPlayProgress\", \"Done\");\n  });\n  intro.onchange(() => {\n    localStorage.setItem(\"introPlayProgress\", \"Done\");\n  });\n  intro.onafterchange((target) => {\n    let parentElem = target.parentElement;\n    while (parentElem !== null) {\n      if (parentElem.dataset.role == \"panel\") {\n        parentElem.style = \"z-index: 1001 !important\";\n        break;\n      } else {\n        parentElem = parentElem.parentElement;\n      }\n    }\n  });\n}\n"],"file":"tutorial.min.js"}